# Example RabbitMQ configuration for the Cert DN Regex Auth Backend Plugin
# This file should be placed in your RabbitMQ configuration directory
# (e.g., /etc/rabbitmq/rabbitmq.conf on Linux, or your custom config path)

# Enable the plugin
plugins.rabbitmq_auth_backend_cert_regex = true

# Configure authentication backends
# Use internal backend for authentication and cert regex for authorization
auth_backends.1.authn = internal
auth_backends.1.authz = rabbit_auth_backend_cert_regex

# Fallback to internal backend for authorization if cert regex fails
auth_backends.2.authz = internal

# SSL/TLS configuration (required for certificate-based authentication)
listeners.ssl.default = 5671
ssl_options.cacertfile = /path/to/ca_certificate.pem
ssl_options.certfile = /path/to/server_certificate.pem
ssl_options.keyfile = /path/to/server_key.pem
ssl_options.verify = verify_peer
ssl_options.fail_if_no_peer_cert = true

# Enable SSL authentication
ssl_options.verify_fun = {rabbit_ssl_verify_fun, {verify_peer_name, []}}

# Logging configuration
log.ssl = true
log.auth = true

# Management plugin configuration
management.listener.port = 15672
management.listener.ssl = false

# Additional SSL settings
ssl_options.honor_cipher_order = true
ssl_options.honor_ecc_order = true
ssl_options.client_renegotiation = false
ssl_options.secure_renegotiate = true
